import{_ as b,M as f,o as a,c as n,a as t,t as i,e as y,v as k,f as g,R as $,m as M,g as w,r as h,F as C,h as x,b as _,n as U,w as T,d as u}from"./index-91dbbf6a.js";import{p as m}from"./cartsProductsStore-686ec88f.js";const S={props:{product:Object,apiUrl:String,apiPath:String},data(){return{productModal:null,tempProduct:{}}},mounted(){this.productModal=new f(this.$refs.modal,{backdrop:"static"})},methods:{addToCart(o,d=1){const r=`${this.apiUrl}/v2/api/${this.apiPath}/cart`,l={product_id:o,qty:d};this.$http.post(r,{data:l}).then(s=>{alert(s.data.message),this.productModal.hide()}).catch(s=>{alert(s)})}},watch:{product(o){this.tempProduct=o,this.productModal.show()}}},L={class:"modal fade",id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},V={class:"modal-dialog modal-xl",role:"document"},q={class:"modal-content border-0"},B={class:"modal-header bg-dark text-white"},N={class:"modal-title",id:"exampleModalLabel"},z=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),D={class:"modal-body"},F={class:"row"},R={class:"col-sm-6"},j=["src"],A={class:"col-sm-6"},E={class:"badge bg-primary rounded-pill"},H={key:0,class:"h5"},I={key:1},O={class:"h6"},G={class:"h5"},J={class:"input-group"};function K(o,d,r,l,s,c){return a(),n("div",L,[t("div",V,[t("div",q,[t("div",B,[t("h5",N,[t("span",null,i(s.tempProduct.title),1)]),z]),t("div",D,[t("div",F,[t("div",R,[t("img",{src:s.tempProduct.imageUrl,class:"img-fluid",alt:""},null,8,j)]),t("div",A,[t("span",E,i(s.tempProduct.category),1),t("p",null,"商品描述："+i(s.tempProduct.description),1),t("p",null,"商品內容："+i(s.tempProduct.content),1),s.tempProduct.price===s.tempProduct.origin_price?(a(),n("div",H,i(s.tempProduct.price)+" 元 ",1)):(a(),n("div",I,[t("del",O,"原價 "+i(s.tempProduct.origin_price)+" 元",1),t("div",G,"現在只要 "+i(s.tempProduct.price)+" 元",1)])),t("div",null,[t("div",J,[y(t("input",{type:"number",class:"form-control",min:"1","onUpdate:modelValue":d[0]||(d[0]=p=>s.tempProduct.qty=p)},null,512),[[k,s.tempProduct.qty,void 0,{number:!0}]]),t("button",{type:"button",class:"btn btn-primary",onClick:d[1]||(d[1]=g(p=>c.addToCart(s.tempProduct.id,s.tempProduct.qty),["prevent"]))}," 加入購物車 ")])])])])])])])],512)}const Q=b(S,[["render",K]]),W={name:"HomeProducts",data(){return{products:[],product:{}}},components:{UserProductModal:Q,RouterLink:$},methods:{openModal(o,d=1){const r=`${this.apiUrl}/v2/api/${this.apiPath}/product/${o}`;this.$http.get(r).then(l=>{this.product={...l.data.product,qty:d}}).catch(l=>{alert(l)})},addToCart(o,d=1){const r=`${this.apiUrl}/v2/api/${this.apiPath}/cart`,l={product_id:o,qty:d};this.$http.post(r,{data:l}).then(s=>{alert(s.data.message)}).catch(s=>{alert(s)})},...M(m,["getProducts"])},computed:{...w(m,["newProducts","apiUrl","apiPath"])},watch:{parentProducts(o){this.products=o}},mounted(){this.getProducts()}},X=t("h1",null,"This is 產品列表頁面",-1),Y={class:"table align-middle"},Z=t("thead",null,[t("tr",null,[t("th",null,"圖片"),t("th",null,"商品名稱"),t("th",null,"價格"),t("th")])],-1),tt={style:{width:"200px"}},st={key:0,class:"h5"},ot={key:1},et={class:"h6"},it={class:"h5"},dt={class:"btn-group btn-group-sm"},lt=["onClick"],at=t("i",{class:"fas fa-spinner fa-pulse"},null,-1),nt=["onClick"],rt=t("i",{class:"fas fa-spinner fa-pulse"},null,-1);function ct(o,d,r,l,s,c){const p=h("router-link"),v=h("user-product-modal");return a(),n("div",null,[X,t("table",Y,[Z,t("tbody",null,[(a(!0),n(C,null,x(o.newProducts,e=>(a(),n("tr",{key:e.id},[t("td",tt,[t("div",{style:U([{height:"100px","background-size":"cover","background-position":"center"},{backgroundImage:`url(${e.imageUrl})`}]),class:"position-relative"},[_(p,{class:"d-block stretched-link",to:`/products/${e.id}`},{default:T(()=>[u(i(e.id),1)]),_:2},1032,["to"])],4)]),t("td",null,i(e.title),1),t("td",null,[e.price===e.origin_price?(a(),n("div",st,i(e.price)+" 元 ",1)):(a(),n("div",ot,[t("del",et,"原價 "+i(e.origin_price)+" 元",1),t("div",it,"現在只要 "+i(e.price)+" 元",1)]))]),t("td",null,[t("div",dt,[t("button",{type:"button",class:"btn btn-outline-secondary",onClick:g(P=>c.openModal(e.id),["prevent"])},[at,u(" 查看更多 ")],8,lt),t("button",{type:"button",class:"btn btn-outline-danger",onClick:P=>c.addToCart(e.id)},[rt,u(" 加到購物車 ")],8,nt)])])]))),128))])]),_(v,{product:s.product,"api-url":o.apiUrl,"api-path":o.apiPath},null,8,["product","api-url","api-path"])])}const ht=b(W,[["render",ct]]);export{ht as default};
